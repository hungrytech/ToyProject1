<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head th:replace="fragments/header :: header"/>
    <body>
    <!-- 상단 바 -->
    <nav th:replace="fragments/bodyHeader :: bodyheader"/>

    <!-- Content -->
    <main class="container" style="margin-top: 55px">
        <div class="row">
            <div class="col"><h1>게시판</h1></div>
            <div class="w-100"></div>
            <div class="col">
                <form th:action="@{/board/{id}/edit(id=${boardInfo.id})}"
                      th:object="${boardInfo}"
                      method="post"
                      enctype="multipart/form-data">
                    <div class="form-group">
                        <label th:for="title">제목</label>
                        <input
                                type="text"
                                class="form-control"
                                maxlength="30"
                                th:readonly="${!result}"
                                th:field="*{title}"
                        />
                    </div>
                    <div class="form-group">
                        <label th:for="content">내용</label>
                        <textarea
                                class="form-control"
                                th:readonly="${!result}"
                                th:field="*{content}"
                                rows="8"
                                maxlength="300"
                        >
                        </textarea>
                    </div>
                    <div th:if="${result}" class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01"
                            >Upload</span
                            >
                        </div>
                        <div class="custom-file">
                            <input
                                    type="file"
                                    class="custom-file-input"
                                    name="file"
                                    id="inputGroupFile01"
                                    aria-describedby="inputGroupFileAddon01"
                                    accept="image/*"
                                    onchange="readURL(this)"
                            />
                            <label th:text="${boardInfo.imgPath!=null} ? '변경할 사진 업로드' : '사진 업로드'"
                                   class="custom-file-label"
                                   for="inputGroupFile01"
                                   id="imgLabel"
                            >Choose file</label
                            >
                        </div>
                    </div>
                    <div id="imgParent">
                        <img
                                id="serverImg"
                                th:if="${boardInfo.imgPath!=null}"
                                th:src="@{'/boardImgs/' + *{imgPath}}"
                                class="img-thumbnail"
                                alt="..."
                                style="width: 500px; height: 500px"
                        />
                    </div>
                    <button th:if="${result}" type="submit" class="btn btn-outline-success">수정</button>
                    <a th:if="${result}"
                       th:href="'javascript:deleteBoard('+${boardInfo.id}+')'"
                       class="btn btn-outline-danger">삭제</a>
                </form>
            </div>
        </div>
    </main>


    <!-- 하단 바 -->
    <footer th:replace="fragments/footer :: footer"/>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script
            src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"
    ></script>
    <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
            crossorigin="anonymous"
    ></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>
    -->

    <script>
        <!-- 삭제요청 -->
        function deleteBoard(id) {
            let form = document.createElement("form");
            form.setAttribute("method", "post");
            form.setAttribute("action", "/board/" + id + "/delete");
            document.body.appendChild(form);
            form.submit();
        }
    </script>

    <!-- 이미지 미리보기 -->
    <script src="/js/imgPreview.js"></script>
    </body>
</html>